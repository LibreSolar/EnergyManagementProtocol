<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MQTT | ThingSet Protocol Specification</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/thingset/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/thingset/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/thingset/favicons/favicon-16x16.png">
    <link rel="manifest" href="/thingset/favicons/site.webmanifest">
    <link rel="mask-icon" href="/thingset/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/thingset/favicons/favicon.ico">
    <meta name="description" content="The ThingSet protocol provides a consistent, standardized way to configure, monitor and control ressource-constrained devices via different communication interfaces like Serial, LoRa, USB, Bluetooth or CAN.">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/thingset/assets/css/0.styles.b6738e8c.css" as="style"><link rel="preload" href="/thingset/assets/js/app.96d59ff3.js" as="script"><link rel="preload" href="/thingset/assets/js/2.d1779d51.js" as="script"><link rel="preload" href="/thingset/assets/js/3.b5a90050.js" as="script"><link rel="preload" href="/thingset/assets/js/22.78cbcf59.js" as="script"><link rel="prefetch" href="/thingset/assets/js/10.68018d76.js"><link rel="prefetch" href="/thingset/assets/js/11.c1808bb4.js"><link rel="prefetch" href="/thingset/assets/js/12.a7be16e5.js"><link rel="prefetch" href="/thingset/assets/js/13.d07fc169.js"><link rel="prefetch" href="/thingset/assets/js/14.dd06c804.js"><link rel="prefetch" href="/thingset/assets/js/15.357e8dac.js"><link rel="prefetch" href="/thingset/assets/js/16.fa8d4a41.js"><link rel="prefetch" href="/thingset/assets/js/17.17f86cc2.js"><link rel="prefetch" href="/thingset/assets/js/18.676a507c.js"><link rel="prefetch" href="/thingset/assets/js/19.2d09fae1.js"><link rel="prefetch" href="/thingset/assets/js/20.ce246fff.js"><link rel="prefetch" href="/thingset/assets/js/21.9683fbc5.js"><link rel="prefetch" href="/thingset/assets/js/23.1948a3d4.js"><link rel="prefetch" href="/thingset/assets/js/24.343174ec.js"><link rel="prefetch" href="/thingset/assets/js/25.d73c4cdd.js"><link rel="prefetch" href="/thingset/assets/js/26.51737012.js"><link rel="prefetch" href="/thingset/assets/js/27.b5c41f22.js"><link rel="prefetch" href="/thingset/assets/js/28.74c7dc8c.js"><link rel="prefetch" href="/thingset/assets/js/29.8dfbd821.js"><link rel="prefetch" href="/thingset/assets/js/30.ac17037f.js"><link rel="prefetch" href="/thingset/assets/js/31.e67d3276.js"><link rel="prefetch" href="/thingset/assets/js/4.b50bddb9.js"><link rel="prefetch" href="/thingset/assets/js/5.dfd9db3d.js"><link rel="prefetch" href="/thingset/assets/js/6.871f1af7.js"><link rel="prefetch" href="/thingset/assets/js/7.a2e8fd4a.js"><link rel="prefetch" href="/thingset/assets/js/8.baf0f7d8.js"><link rel="prefetch" href="/thingset/assets/js/9.e6d42c89.js">
    <link rel="stylesheet" href="/thingset/assets/css/0.styles.b6738e8c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/thingset/" class="home-link router-link-active"><img src="/thingset/favicons/apple-touch-icon.png" alt="ThingSet Protocol Specification" class="logo"> <span class="site-name">ThingSet Protocol Specification</span></a> <div class="links"><div class="search-box can-hide"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="History Menu" class="dropdown-title"><span class="title">History</span> <span class="arrow down"></span></button> <button type="button" aria-label="History Menu" class="mobile-dropdown-title"><span class="title">History</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/thingset/" class="nav-link">
  v0.3
</a></li><li class="dropdown-item"><!----> <a href="/thingset/v0.2/" class="nav-link">
  v0.2
</a></li><li class="dropdown-item"><!----> <a href="/thingset/v0.1/" class="nav-link">
  v0.1
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="History Menu" class="dropdown-title"><span class="title">History</span> <span class="arrow down"></span></button> <button type="button" aria-label="History Menu" class="mobile-dropdown-title"><span class="title">History</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/thingset/" class="nav-link">
  v0.3
</a></li><li class="dropdown-item"><!----> <a href="/thingset/v0.2/" class="nav-link">
  v0.2
</a></li><li class="dropdown-item"><!----> <a href="/thingset/v0.1/" class="nav-link">
  v0.1
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Why ThingSet?</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/thingset/1b_existing_solutions.html" class="sidebar-link">Existing Standards</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Application Layer</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/2a_general.html" class="sidebar-link">General Concept</a></li><li><a href="/thingset/2b_text_mode.html" class="sidebar-link">Text Mode</a></li><li><a href="/thingset/2c_binary_mode.html" class="sidebar-link">Binary Mode</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Lower Layers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/3a_serial.html" class="sidebar-link">Serial</a></li><li><a href="/thingset/3b_can.html" class="sidebar-link">CAN</a></li><li><a href="/thingset/3c_lora.html" class="sidebar-link">LoRa</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Protocol Mapping</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/4a_http.html" class="sidebar-link">HTTP</a></li><li><a href="/thingset/4b_coap.html" class="sidebar-link">CoAP</a></li><li><a href="/thingset/4c_mqtt.html" aria-current="page" class="active sidebar-link">MQTT</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/thingset/4c_mqtt.html#publication" class="sidebar-link">Publication</a></li><li class="sidebar-sub-header"><a href="/thingset/4c_mqtt.html#subscription" class="sidebar-link">Subscription</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Tools</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/thingset/5a_serial.html" class="sidebar-link">Serial</a></li><li><a href="/thingset/5b_can.html" class="sidebar-link">CAN bus</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="thingset-to-mqtt-mapping"><a href="#thingset-to-mqtt-mapping" class="header-anchor">#</a> ThingSet to MQTT mapping</h1> <p>The MQTT protocol doesn't support the request/response part of the ThingSet protocol, but the publish/subscribe messaging pattern can be easily mapped.</p> <h2 id="publication"><a href="#publication" class="header-anchor">#</a> Publication</h2> <p>The topic used to publish to the MQTT server may contain the path of the data nodes. The topic name itself could be stored as a data node, but it's not relevant to the implementation of publication messages in the ThingSet protocool.</p> <p>A ThingSet publication message starts with a first byte 0x1F in binary mode or &quot;# &quot; in text mode to indicate a publication message. Whether this byte is also stored in the MQTT topic depends on the application.</p> <p>If a single measurement value is stored in an MQTT topic (e.g. /devices/device-id/Bat_V for the battery voltage), it is recommended that only the JSON or CBOR payload data is stored in the MQTT payload and the path of the ThingSet endpoint is contained in the topic.</p> <p>If multiple data nodes are stored in the same topic, the entire ThingSet publication message could be stored to allow direct passing between MQTT topic and ThingSet.</p> <h2 id="subscription"><a href="#subscription" class="header-anchor">#</a> Subscription</h2> <p>Content fetched from a specific topic is forwarded to the ThingSet protocol as a publication message. The ThingSet device will parse the incoming data similar to a PATCH request. Unknown data nodes contained in the subscribed payload are silently ignored.</p> <p>If the application requires some processing of incoming data before applying them to actual nodes, temporary data nodes can be created where the subscribed content is written to. Afterwards a function is called (assigned as a callback to the sub channel node) to process the incoming data and pass it on to the actual nodes.</p> <p>This approach can also be used to determine if the received data has changed compared to already existing state and avoid too many storage operations in EEPROM for regularly published messages.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/26/2021, 2:03:57 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/thingset/4b_coap.html" class="prev">
        CoAP
      </a></span> <span class="next"><a href="/thingset/5a_serial.html">
        Serial
      </a>
      →
    </span></p></div>  <div class="footer">
    Content provided by <a href="https://libre.solar">Libre Solar</a> under <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">CC-BY-SA 4.0 License</a> | <a href="https://libre.solar/about/contact/">Contact / Impressum</a></div></main></div><div class="global-ui"></div></div>
    <script src="/thingset/assets/js/app.96d59ff3.js" defer></script><script src="/thingset/assets/js/2.d1779d51.js" defer></script><script src="/thingset/assets/js/3.b5a90050.js" defer></script><script src="/thingset/assets/js/22.78cbcf59.js" defer></script>
  </body>
</html>
